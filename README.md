-- ================================================================
-- DevifyX MySQL Assignment: Password Reset & Email Verification
-- Author: [Varsha]
-- File: devifyx-mysql-assignment-[varsha].sql
-- Description:
--   This SQL script implements a secure and efficient password recovery
--   and email verification system using MySQL 8.0 only (no external code).
--
-- üîß Features Implemented:
-- ---------------------------------------------------------------
-- ‚úÖ User Management:
--    - Normalized user table with email, hashed password, verification status
--
-- ‚úÖ Email Verification:
--    - Token generation, expiry check, max usage (multi-use support)
--    - Procedure to initiate and complete verification
--
-- ‚úÖ Password Reset:
--    - Secure reset tokens with expiry and multi-use logic
--    - Reset procedure with safety checks
--
-- ‚úÖ Token Generation Logic:
--    - UUID-based unique token generator (MySQL FUNCTION)
--
-- ‚úÖ Token Expiry & Management:
--    - Validation inside logic
--    - Auto-cleanup of expired entries (EVENT every 1 hour)
--
-- ‚úÖ Audit Logging:
--    - All key actions recorded in audit_log table
--
-- ‚≠ê Bonus Features:
-- ---------------------------------------------------------------
-- ‚úÖ Rate Limiting: Max 3 requests/hour per action per user
-- ‚úÖ Multi-use Tokens: Controlled by max_uses field
-- ‚úÖ Auto Cleanup: Expired tokens and logs cleared periodically
--
-- üß™ Sample Data & Usage:
-- ---------------------------------------------------------------
--  - INSERT statements for 2 test users
--  - CALL examples provided for each procedure
--
-- üí° Technical Notes:
-- ---------------------------------------------------------------
-- - Requires MySQL 8.0 or higher
-- - Uses only MySQL features: tables, functions, procedures, events
-- - No frontend or backend integration included
--
-- ‚úÖ Ready for direct execution and testing.
-- ==============================================================

